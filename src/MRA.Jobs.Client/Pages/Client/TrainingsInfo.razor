@*@page "/trainings/{slug}"*@
@page "/TrainingsInfo"
@using Blazored.LocalStorage;
@using MRA.Jobs.Application.Contracts.TrainingVacancies.Responses;
@using Microsoft.AspNetCore.Components.Authorization;
@inject AuthenticationStateProvider provider
@inject ILocalStorageService LocalStorage;

@layout Main
@inject ITrainingService _trainingService

<div class="container">
	@if (_training == null)
	{
		<span>Loading...</span>
	}
	else
	{
		<h1>@_training.Title</h1>
		<div class="w-100 d-flex flex-row justify-content-between">
			<div class="Trainings w-100 bg-white shadow-lg rounded mb-4">
				<div class="d-flex flex-column p-3">

					<h3 class="mb-2 text-black">
						Description:
					</h3>
					<p class="mb-2 text-black">@_training.Description</p>
					<h3 class="mb-2 text-black">
						EndDate:
					</h3>
					<p class="mb-2 text-black">@_training.EndDate</p>
					<h3 class="mb-2 text-black">
						Duration:
					</h3>
					<p class="mb-2 text-black">@_training.Duration</p>
					<h3 class="mb-2 text-black">
						Fees:
					</h3>
					<p class="mb-2 text-black">@_training.Fees</p>
				</div>
			</div>
			@*button*@
			<div class="Trainingsinfo">

				<div class="w-100 d-flex flex-row justify-content-between">
					<div class="card w-100 bg-white shadow-lg rounded mb-4">
						<div class="card-body">
							<h2 class="mb-2 text-black">Interested in a trainings?</h2>
							<a href="ApplytoTrainings/{@_training.Slug}" class="btn btn-primary">Apply</a>
							@*<CascadingAuthenticationState>
								<AuthorizeView>
									<Authorized>
										<a href="ApplytoTrainings/{@_training.Slug}/{@_training.Id}" class="btn btn-primary">Apply</a>
									</Authorized>
									<NotAuthorized>
										<a href="login" class="btn btn-primary">Aply</a>
									</NotAuthorized>
								</AuthorizeView>
							</CascadingAuthenticationState>*@
						</div>
					</div>
				</div>
			</div>
		</div>
	}
</div>



@code {
	//[Parameter]
	public string Slug = "-2023-8";
	private TrainingVacancyDetailedResponse _training { get; set; } = new TrainingVacancyDetailedResponse();

	protected override async Task OnInitializedAsync()
	{
		_training = await _trainingService.GetBySlugSinceCheckDate(Slug);
	}
	public int ApplicantId { get; set; }
	protected async Task SaveAndRetrieveData()
	{
		await LocalStorage.SetItemAsync("Trainingid", $"{_training.Id}");
		await LocalStorage.SetItemAsync("Applicant", $"{ApplicantId}");
	}
}