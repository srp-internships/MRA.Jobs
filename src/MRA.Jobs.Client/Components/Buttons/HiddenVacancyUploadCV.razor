@using MRA.Jobs.Application.Contracts.NoVacancies.Responses
@using MRA.Jobs.Client.Services.NoVacancies
@inject NavigationManager NavigationManager
@inject INoVacancyService NoVacancyService
@inject IContentService ContentService


  <CascadingAuthenticationState>
            <AuthorizeView>
                <Authorized>
                    @if (_applicationWithNoVacancyStatus == null || !_applicationWithNoVacancyStatus.Applied)
                    {
                        <MudCardContent>
                            <MudText>
						@ContentService["Profile:Ifyouwouldliketonominateyourself,sendusyourСV."]
                            </MudText>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Filled" Color="Color.Primary"
                                       OnClick="ApplyHiddenVacancy" FullWidth="true">
						<MudText>@ContentService["Profile:UploadCV"]</MudText>
                            </MudButton>
                        </MudCardActions>
                    }
                    else
                    {
                        <MudCardContent>
                            <MudText>
						@ContentService["Profile:ThestatusofyourCVforyourcandidacyis"] <b>@_applicationWithNoVacancyStatus.Status.ToString()</b>
                            </MudText>
                        </MudCardContent>
                        @if (_applicationWithNoVacancyStatus.Status == ApplicationStatusDto.ApplicationStatus.Expired
                             || _applicationWithNoVacancyStatus.Status == ApplicationStatusDto.ApplicationStatus.Rejected
                             || _applicationWithNoVacancyStatus.Status == ApplicationStatusDto.ApplicationStatus.Refused)
                        {
                            <MudCardActions>
                                <MudButton Variant="Variant.Filled" Color="Color.Primary"
                                           OnClick="ApplyHiddenVacancy" FullWidth="true">
							<MudText>@ContentService["Profile:UploadNewCV"]</MudText>
                                </MudButton>
                            </MudCardActions>
                        }
                    }
                </Authorized>
                <NotAuthorized>

                    <MudCardContent>
                        <MudText >
					@ContentService["Profile:Ifyouwouldliketonominateyourself,signinandsendusyourСV."]
                        </MudText>
                    </MudCardContent>
                    <MudCardActions>
                        <MudButton Variant="Variant.Filled" OnClick="SignIn" Color="Color.Primary" FullWidth="true">
					<MudText>@ContentService["VacancyDetails:Sign In"]</MudText>
                        </MudButton>
                    </MudCardActions>


                </NotAuthorized>
            </AuthorizeView>
        </CascadingAuthenticationState>

@code {
    private ApplicationWithNoVacancyStatus _applicationWithNoVacancyStatus;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        _applicationWithNoVacancyStatus = await NoVacancyService.GetApplicationStatus();
    }

    private void ApplyHiddenVacancy()
    {
        NavigationManager.NavigateTo("/upload-cv");
    }

    private void SignIn()
    {
        NavigationManager.NavigateTo("/sign-in");
    }

}