@page "/VerifyEmail"
@using Microsoft.AspNetCore.WebUtilities
@inject NavigationManager NavigationManager
@inject IAuthService AuthService

@code {


    [Parameter] public string Token { get; set; }
    [Parameter] public string UserId { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var uri = NavigationManager.ToAbsoluteUri(NavigationManager.Uri);

        if (QueryHelpers.ParseQuery(uri.Query).TryGetValue("token", out var tokenValue))
        {
            Token = tokenValue;
        }

        if (QueryHelpers.ParseQuery(uri.Query).TryGetValue("userId", out var userIdValue))
        {
            UserId = userIdValue;
        }

        Console.WriteLine(Token);
        Console.WriteLine(UserId);
        await AuthService.SendVerificationEmailToken(Token, UserId);
        NavigationManager.NavigateTo("/");
    }

}