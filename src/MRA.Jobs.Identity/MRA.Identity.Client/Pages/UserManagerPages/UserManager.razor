@page "/UserManager"

<Header />

<MudGrid>
    <MudItem xs="12">
        <MudTable ServerData="@(new Func<TableState, Task<TableData<UserResponse>>>(ServerReload))" Hover="true"
                  @ref="_table" Breakpoint="Breakpoint.None">
            <ToolBarContent>
				<MudText Typo="Typo.h5"><b>@ContentService["UserManager:Users"]</b></MudText>
                <MudSpacer/>
				<MudTextField T="string" ValueChanged="@(s => OnSearch(s))" Placeholder=@ContentService["UserManager:Searchname"]
                              Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"
                              Class="mt-0" Immediate="true">
                </MudTextField>
            </ToolBarContent>

            <HeaderContent>
                <MudTh>
					<MudTableSortLabel SortLabel="UserName_field" T="UserResponse">@ContentService["SignUp:UserName"]</MudTableSortLabel>
                </MudTh>
                <MudTh>
						<MudTableSortLabel SortLabel="FullName_field" T="UserResponse">@ContentService["UserManager:FullName"]</MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortLabel="EmailConfirmed_field" T="UserResponse"></MudTableSortLabel>
                </MudTh>
                <MudTh>
						<MudTableSortLabel SortLabel="Email_field" T="UserResponse">@ContentService["SignUp:Email"]</MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortLabel="PhoneNumberConfirmed_field" T="UserResponse"></MudTableSortLabel>
                </MudTh>
                <MudTh>
						<MudTableSortLabel SortLabel="PhoneNumber_field" T="UserResponse">@ContentService["ResetPassword:PhoneNumber"]</MudTableSortLabel>
                </MudTh>
					<MudTh>@ContentService["UserManager:Roles"]</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd>@context.UserName</MudTd>
                <MudTd>@context.FullName</MudTd>
                <MudTd>
                    @if (context.EmailConfirmed)
                    {
                        <MudIcon Icon="@Icons.Material.Filled.CheckCircle" Color="Color.Success"/>
                    }
                    else
                    {
                        <MudIcon Icon="@Icons.Material.Filled.Warning" Color="Color.Error"/>
                    }
                </MudTd>
                <MudTd>@context.Email</MudTd>
                <MudTd>
                    @if (context.PhoneNumberConfirmed)
                    {
                        <MudIcon Icon="@Icons.Material.Filled.CheckCircle" Color="Color.Success"/>
                    }
                    else
                    {
                        <MudIcon Icon="@Icons.Material.Filled.Warning" Color="Color.Error"/>
                    }
                </MudTd>
                <MudTd>@context.PhoneNumber</MudTd>
                <MudTd>
                    @{
                        var userRolesLink = $"/UserRoles/{context.UserName}";
                    }
                    <MudStack Row="true">
                        <MudButton Variant="Variant.Filled" href="@userRolesLink">
                            <MudIcon Icon="@Icons.Material.Filled.MoreHoriz"/>
                        </MudButton>
                    </MudStack>
                </MudTd>
            </RowTemplate>
            <NoRecordsContent>
				<MudText>@ContentService["UserManager:Nomatchingrecords"]</MudText>
            </NoRecordsContent>
            <LoadingContent>
					<MudText>@ContentService["UserManager:Loading"]</MudText>
            </LoadingContent>
            <PagerContent>
                <MudTablePager/>
            </PagerContent>
        </MudTable>
    </MudItem>
</MudGrid>